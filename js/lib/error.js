define(["underscore","jquery","toolbox","i18n"],function(_,$,Toolbox,i18n){var Error=Toolbox.Base.extend({constructor:function(){this.i18n=i18n},ERROR_OK:0,ERROR_ERROR:-1,language:"en",el:null,msg:null,prefix:"error_",showMultipleErrors:false,multipleErrorFields:false,wasReset:false,errors:[],show:function(){if(this.multipleErrorFields)_.each(this.errors,function(e){e.el.html(e.msg).show()});else{this.$msg.empty().append(this.errors.shift());this.$el.show()}this.wasReset=false},hide:function(){this.multipleErrorFields?
_.each(this.errors,function(e){e.el.hide()}):this.$el.hide()},reset:function(){this.errors=[];this.wasReset=true},parseError:function(){var args=arguments[0];var $field=args[0]?args[0]:null;var rules=args[1]?args[1]:null;if(!$field||!rules)return;if(!this.wasReset){this.hide();this.reset()}this.multipleErrorFields?this.errors.push({el:$("#"+this.prefix+$field.attr("id")),msg:this.i18n[this.language].error[$field.attr("id")][rules[0].rule]}):this.errors.push(this.i18n[this.language].error[$field.attr("id")][rules[0].rule])}});
return new Error});